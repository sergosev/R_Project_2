typed_data %>%
select(where(is.numeric)) %>%
pivot_longer(cols = everything(), names_to = 'variables', values_to = 'values') %>%
mutate(variables = as.factor(variables)) %>%
ggplot(aes(x = variables, y = values)) +
geom_violin()
typed_data %>%
select(where(is.numeric)) %>%
pivot_longer(cols = everything(), names_to = 'variables', values_to = 'values') %>%
mutate(variables = as.factor(variables)) %>%
ggplot(aes(x = variables, y = values)) +
geom_boxplot()
typed_data %>%
select(where(is.numeric)) %>%
pivot_longer(cols = everything(), names_to = 'variables', values_to = 'values') %>%
mutate(variables = as.factor(variables)) %>%
ggplot(aes(x = variables, y = values)) +
geom_boxplot() +
facet_wrap(~ variables, scales = "free")
typed_data %>%
select(where(is.numeric)) %>%
pivot_longer(cols = everything(), names_to = 'variables', values_to = 'values') %>%
mutate(variables = as.factor(variables)) %>%
ggplot(aes(x = variables, y = values)) +
geom_boxplot() +
facet_wrap(~ variables, scales = "free", ncol = 3)
typed_data %>%
select(where(is.numeric)) %>%
pivot_longer(cols = everything(), names_to = 'variables', values_to = 'values') %>%
mutate(variables = as.factor(variables)) %>%
group_by(variables) %>%
mutates(scaled_values = scale(values)) %>%
ungroup() %>%
ggplot(aes(x = variables, y = values)) +
geom_boxplot()
typed_data %>%
select(where(is.numeric)) %>%
pivot_longer(cols = everything(), names_to = 'variables', values_to = 'values') %>%
mutate(variables = as.factor(variables)) %>%
group_by(variables) %>%
mutate(scaled_values = scale(values)) %>%
ungroup() %>%
ggplot(aes(x = variables, y = values)) +
geom_boxplot()
typed_data %>%
select(where(is.numeric)) %>%
pivot_longer(cols = everything(), names_to = 'variables', values_to = 'values') %>%
mutate(variables = as.factor(variables)) %>%
group_by(variables) %>%
mutate(scaled_values = scale(values)) %>%
ungroup() %>%
ggplot(aes(x = variables, y = values)) +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
typed_data %>%
select(where(is.numeric)) %>%
pivot_longer(cols = everything(), names_to = 'variables', values_to = 'values') %>%
mutate(variables = as.factor(variables)) %>%
group_by(variables) %>%
mutate(scaled_values = scale(values)) %>%
ungroup() %>%
ggplot(aes(x = variables, y = scaled_values)) +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
typed_data %>%
select(where(is.numeric)) %>%
pivot_longer(cols = everything(), names_to = 'variables', values_to = 'values') %>%
mutate(variables = as.factor(variables)) %>%
group_by(variables) %>%
mutate(scaled_values = scale(values)) %>%
ungroup() %>%
ggplot(aes(x = variables, y = scaled_values)) +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(y = "Z-standartized data", x = "")
typed_data %>%
select(where(is.numeric)) %>%
pivot_longer(cols = everything(), names_to = 'variables', values_to = 'values') %>%
mutate(variables = as.factor(variables)) %>%
group_by(variables) %>%
mutate(scaled_values = scale(values)) %>%
ungroup() %>%
ggplot(aes(x = variables, y = scaled_values, fill = variables)) +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(y = "Z-standartized data", x = "")
typed_data %>%
select(where(is.numeric)) %>%
pivot_longer(cols = everything(), names_to = 'variables', values_to = 'values') %>%
mutate(variables = as.factor(variables)) %>%
group_by(variables) %>%
mutate(scaled_values = scale(values)) %>%
ungroup() %>%
ggplot(aes(x = variables, y = scaled_values, fill = variables)) +
geom_boxplot() +
theme(axis.text.x = blank) +
labs(y = "Z-standartized values", x = "")
typed_data %>%
select(where(is.numeric)) %>%
pivot_longer(cols = everything(), names_to = 'variables', values_to = 'values') %>%
mutate(variables = as.factor(variables)) %>%
group_by(variables) %>%
mutate(scaled_values = scale(values)) %>%
ungroup() %>%
ggplot(aes(x = variables, y = scaled_values, fill = variables)) +
geom_boxplot() +
theme(axis.text.x = element_blank()) +
labs(y = "Z-standartized values", x = "")
typed_data %>%
select(where(is.numeric)) %>%
pivot_longer(cols = everything(), names_to = 'variables', values_to = 'values') %>%
mutate(variables = as.factor(variables)) %>%
group_by(variables) %>%
mutate(scaled_values = scale(values)) %>%
ungroup() %>%
ggplot(aes(x = variables, y = scaled_values, fill = variables)) +
geom_boxplot() +
theme(axis.text.x = element_blank()) +
labs(y = "Z-standartized values", x = "") +
theme_alafoli()
typed_data %>%
select(where(is.numeric)) %>%
pivot_longer(cols = everything(), names_to = 'variables', values_to = 'values') %>%
mutate(variables = as.factor(variables)) %>%
group_by(variables) %>%
mutate(scaled_values = scale(values)) %>%
ungroup() %>%
ggplot(aes(x = variables, y = scaled_values, fill = variables)) +
geom_boxplot() +
theme(axis.text.x = element_blank()) +
labs(y = "Z-standartized values", x = "") +
theme_apa()
typed_data %>%
select(where(is.numeric)) %>%
pivot_longer(cols = everything(), names_to = 'variables', values_to = 'values') %>%
mutate(variables = as.factor(variables)) %>%
group_by(variables) %>%
mutate(scaled_values = scale(values)) %>%
ungroup() %>%
ggplot(aes(x = variables, y = scaled_values, fill = variables)) +
geom_boxplot() +
theme(axis.text.x = element_blank()) +
labs(y = "Z-standartized values", x = "") +
theme_dark()
typed_data %>%
select(where(is.numeric)) %>%
pivot_longer(cols = everything(), names_to = 'variables', values_to = 'values') %>%
mutate(variables = as.factor(variables)) %>%
group_by(variables) %>%
mutate(scaled_values = scale(values)) %>%
ungroup() %>%
ggplot(aes(x = variables, y = scaled_values, fill = variables)) +
geom_boxplot() +
theme(axis.text.x = element_blank()) +
labs(y = "Z-standartized values", x = "") +
theme_minimal()
typed_data %>%
select(where(is.numeric)) %>%
pivot_longer(cols = everything(), names_to = 'variables', values_to = 'values') %>%
mutate(variables = as.factor(variables)) %>%
group_by(variables) %>%
mutate(scaled_values = scale(values)) %>%
ungroup() %>%
ggplot(aes(x = variables, y = scaled_values, fill = variables)) +
geom_boxplot() +
theme_minimal()
theme(axis.text.x = element_blank()) +
labs(y = "Z-standartized values", x = "")
typed_data %>%
select(where(is.numeric)) %>%
pivot_longer(cols = everything(), names_to = 'variables', values_to = 'values') %>%
mutate(variables = as.factor(variables)) %>%
group_by(variables) %>%
mutate(scaled_values = scale(values)) %>%
ungroup() %>%
ggplot(aes(x = variables, y = scaled_values, fill = variables)) +
geom_boxplot() +
theme_bw()
theme(axis.text.x = element_blank()) +
labs(y = "Z-standartized values", x = "")
typed_data %>%
select(where(is.numeric)) %>%
pivot_longer(cols = everything(), names_to = 'variables', values_to = 'values') %>%
mutate(variables = as.factor(variables)) %>%
group_by(variables) %>%
mutate(scaled_values = scale(values)) %>%
ungroup() %>%
ggplot(aes(x = variables, y = scaled_values, fill = variables)) +
geom_boxplot() +
theme_bw(axis.text.x = element_blank()) +
labs(y = "Z-standartized values", x = "")
typed_data %>%
select(where(is.numeric)) %>%
pivot_longer(cols = everything(), names_to = 'variables', values_to = 'values') %>%
mutate(variables = as.factor(variables)) %>%
group_by(variables) %>%
mutate(scaled_values = scale(values)) %>%
ungroup() %>%
ggplot(aes(x = variables, y = scaled_values, fill = variables)) +
geom_boxplot() +
theme_bw() +
theme(axis.text.x = element_blank()) +
labs(y = "Z-standartized values", x = "")
knitr::opts_chunk$set(echo = TRUE,
error = FALSE,
warning = FALSE,
message = FALSE)
#Задаем рабочую директорию
main_dir <- dirname(rstudioapi::getSourceEditorContext()$path)
setwd(main_dir)
#Подгружаем библиотеки
library(tidyr)
library(dplyr)
library(ggplot2)
library(flextable)
library(psych)
library(tibble)
library(car)
library(readr)
data <- read_csv("dataset_1_diabetes.csv")
table(is.na(data))
as.data.frame(sapply(data, class)) %>%
rownames_to_column() %>%
rename("Переменная" = rowname, "Тип данных" = "sapply(data, class)") %>%
flextable()
sapply(data[c(2:7, 13:15, 30:31)], unique)
typed_data <- data %>%
mutate(across(c(gender, ethnicity, education_level, income_level, employment_status, smoking_status, diabetes_stage),
as.factor),
across(c(family_history_diabetes, hypertension_history, cardiovascular_history, diagnosed_diabetes),
~ as.factor(ifelse(. == 1, "yes", "no"))))
typed_data %>%
select(where(is.numeric)) %>%
pivot_longer(cols = everything(), names_to = 'variables', values_to = 'values') %>%
mutate(variables = as.factor(variables)) %>%
group_by(variables) %>%
mutate(scaled_values = scale(values)) %>%
ungroup() %>%
ggplot(aes(x = variables, y = scaled_values, fill = variables)) +
geom_boxplot() +
theme_bw() +
theme(axis.text.x = element_blank()) +
labs(y = "Z-standartized values", x = "")
max(typed_data$physical_activity_minutes_per_week)
max(typed_data$physical_activity_minutes_per_week)
typed_data[typed_data$physical_activity_minutes_per_week == 751]
max(typed_data$physical_activity_minutes_per_week)
typed_data[typed_data$physical_activity_minutes_per_week == 751, ]
max(typed_data$physical_activity_minutes_per_week)
typed_data[typed_data$physical_activity_minutes_per_week == 751, ] %>%
flextable()
View(typed_data)
max(typed_data$physical_activity_minutes_per_week)
typed_data[typed_data$physical_activity_minutes_per_week == 751, ] %>%
select(age, gender, smoking_status,
alcohol_consumption_per_week, physical_activity_minutes_per_week,
diagnosed_diabetes, diabetes_stage) %>%
flextable()
typed_data %>%
rownames_to_column()
outlier_graph_data <- typed_data %>%
rownames_to_column() %>%
rename("ID" = rowname) %>%
select(where(~ is.numeric(.)) %>% # выбрали количественные переменные
pivot_longer(-ID, names_to = "vars1", values_to = "vals1") %>% # перевели в длинный формат
full_join(typed_data %>%                              #объединяем с такой же длинной таблицей попарно
select(where(~ is.numeric(.))) %>%
pivot_longer(-ID, names_to = 'vars2', values_to = 'vals2'),
by = 'instant') %>%
filter(vars1 != vars2)   # удаляем диагональ
ggplot(outlier_graph_data, aes(x = vals1, y = vals2))+ # создаем оси Х и У
typed_data %>%
rownames_to_column() %>%
rename("ID" = rowname) %>%
select(where(~ is.numeric(.)) %>% # выбрали количественные переменные
pivot_longer(-ID, names_to = "vars1", values_to = "vals1") %>% # перевели в длинный формат
full_join(typed_data %>%                              #объединяем с такой же длинной таблицей попарно
select(where(~ is.numeric(.))) %>%
pivot_longer(-ID, names_to = 'vars2', values_to = 'vals2'),
by = 'instant') %>%
filter(vars1 != vars2)
outlier_graph_data <- typed_data %>%
outlier_graph_data <- typed_data %>%
rownames_to_column("ID") %>%
select(where(~ is.numeric(.)) %>% # выбрали количественные переменные
pivot_longer(-ID, names_to = "vars1", values_to = "vals1") %>% # перевели в длинный формат
full_join(typed_data %>%                              #объединяем с такой же длинной таблицей попарно
select(where(~ is.numeric(.))) %>%
pivot_longer(-ID, names_to = 'vars2', values_to = 'vals2'),
by = 'instant') %>%
filter(vars1 != vars2)   # удаляем диагональ
ggplot(outlier_graph_data, aes(x = vals1, y = vals2))+ # создаем оси Х и У
outlier_graph_data <- typed_data %>%
rownames_to_column("ID") %>%
select(where(is.numeric)) %>% # выбрали количественные переменные
pivot_longer(-ID, names_to = "vars1", values_to = "vals1") %>% # перевели в длинный формат
full_join(typed_data %>%                              #объединяем с такой же длинной таблицей попарно
select(where(is.numeric)) %>%
pivot_longer(-ID, names_to = 'vars2', values_to = 'vals2'),
by = 'ID') %>%
filter(vars1 != vars2)   # удаляем диагональ
outlier_graph_data <- typed_data %>%
rownames_to_column("ID") %>%
mutate(ID = as.numeric(ID)) %>%
select(where(is.numeric)) %>% # выбрали количественные переменные
pivot_longer(-ID, names_to = "vars1", values_to = "vals1") %>% # перевели в длинный формат
full_join(typed_data %>%                              #объединяем с такой же длинной таблицей попарно
select(where(is.numeric)) %>%
pivot_longer(-ID, names_to = 'vars2', values_to = 'vals2'),
by = 'ID') %>%
filter(vars1 != vars2)   # удаляем диагональ
outlier_graph_data <- typed_data %>%
rownames_to_column("ID") %>%
mutate(ID = as.numeric(ID)) %>%
select(where(is.numeric)) %>% # выбрали количественные переменные
pivot_longer(-ID, names_to = "vars1", values_to = "vals1") %>% # перевели в длинный формат
full_join(typed_data %>%                              #объединяем с такой же длинной таблицей попарно
select(where(is.numeric)) %>%
pivot_longer(names_to = 'vars2', values_to = 'vals2'),
by = 'ID') %>%
filter(vars1 != vars2)   # удаляем диагональ
outlier_graph_data <- typed_data %>%
rownames_to_column("ID") %>%
select(where(is.numeric)) %>%                                  # выбрали количественные переменные
pivot_longer(-ID, names_to = "vars1", values_to = "vals1") %>% # перевели в длинный формат
full_join(typed_data %>%                                       # объединяем с такой же длинной таблицей попарно
rownames_to_column("ID") %>%
select(where(is.numeric)) %>%
pivot_longer(-ID, names_to = 'vars2', values_to = 'vals2'),
by = 'ID') %>%
filter(vars1 != vars2)                                         # удаляем диагональ
outlier_graph_data <- typed_data %>%
rownames_to_column("ID") %>%
mutate(ID = as.numeric(ID)) %>%
select(where(is.numeric)) %>%                                  # выбрали количественные переменные
pivot_longer(-ID, names_to = "vars1", values_to = "vals1") %>% # перевели в длинный формат
full_join(typed_data %>%                                       # объединяем с такой же длинной таблицей попарно
rownames_to_column("ID") %>%
mutate(ID = as.numeric(ID)) %>%
select(where(is.numeric)) %>%
pivot_longer(-ID, names_to = 'vars2', values_to = 'vals2'),
by = 'ID') %>%
filter(vars1 != vars2)                                         # удаляем диагональ
ggplot(outlier_graph_data, aes(x = vals1, y = vals2))+           # создаем оси Х и У
geom_point(size=0.5)+                                          # рисуем дот плот
facet_grid(vars2 ~ vars1, scales='free')+
theme_bw()                                                     # делим дот плоты по соответствующим панелям
typed_data %>%
describe()
typed_data %>%
describe() %>%
rownames_to_column("Variables")
typed_data %>%
describe() %>%
rownames_to_column("Variables") %>%
select(Variables, mean, sd, median, min, max) %>%
flextable()
typed_data %>%
select(where(is.numeric)) %>%
describe() %>%
rownames_to_column("Variables") %>%
select(Variables, mean, sd, median, min, max) %>%
flextable()
typed_data %>%
select(where(is.numeric)) %>%
describe() %>%
rownames_to_column("Variables") %>%
select(Variables, mean, sd, median, min, max) %>%
flextable() %>%
align(align="center")
typed_data %>%
select(where(is.numeric)) %>%
describe() %>%
rownames_to_column("Variables") %>%
select(Variables, mean, sd, median, min, max) %>%
mutate(across(where(is.numeric), ~ round(., 2))) %>%
flextable() %>%
align(align="center")
typed_data %>%
select(where(is.numeric)) %>%
describe() %>%
rownames_to_column("Variables") %>%
select(Variables, mean, sd, median, min, max) %>%
mutate(across(where(is.numeric), ~ round(., 2))) %>%
flextable() %>%
typed_data %>%
select(where(is.numeric)) %>%
describe() %>%
rownames_to_column("Variables") %>%
select(Variables, mean, sd, median, min, max) %>%
mutate(across(where(is.numeric), ~ round(., 2))) %>%
flextable()
typed_data %>%
select(where(is.numeric)) %>%
describe() %>%
rownames_to_column("Variables") %>%
select(Variables, mean, sd, median, min, max) %>%
mutate(across(where(is.numeric), ~ round(., 2))) %>%
flextable()
typed_data %>%
select(where(is.factor)) %>%
summary()
typed_data %>%
select(where(is.numeric)) %>%
describe() %>%
rownames_to_column("Variables") %>%
select(Variables, mean, sd, median, min, max) %>%
mutate(across(where(is.numeric), ~ round(., 2))) %>%
flextable()
typed_data %>%
select(where(is.factor)) %>%
summary()
max(typed_data$physical_activity_minutes_per_week)
typed_data[typed_data$physical_activity_minutes_per_week == 751, ] %>%
select(age = Age, gender = Gender, smoking_status = Smoking,
alcohol_consumption_per_week = "Alcohol Consumption per Week", physical_activity_minutes_per_week = "Physical activity, min/week",
diagnosed_diabetes = "Diagnosed Diabetes", diabetes_stage = "Diabetes Stage") %>%
rowna
max(typed_data$physical_activity_minutes_per_week)
typed_data[typed_data$physical_activity_minutes_per_week == 751, ] %>%
select(age = Age, gender = Gender, smoking_status = Smoking,
alcohol_consumption_per_week = "Alcohol Consumption per Week", physical_activity_minutes_per_week = "Physical activity, min/week",
diagnosed_diabetes = "Diagnosed Diabetes", diabetes_stage = "Diabetes Stage") %>%
flextable()
max(typed_data$physical_activity_minutes_per_week)
typed_data[typed_data$physical_activity_minutes_per_week == 751, ] %>%
select(age = "Age", gender = "Gender", smoking_status = "Smoking",
alcohol_consumption_per_week = "Alcohol Consumption per Week", physical_activity_minutes_per_week = "Physical activity, min/week",
diagnosed_diabetes = "Diagnosed Diabetes", diabetes_stage = "Diabetes Stage") %>%
flextable()
max(typed_data$physical_activity_minutes_per_week)
typed_data[typed_data$physical_activity_minutes_per_week == 751, ] %>%
select("Age" = age, "Gender" = gender, "Smoking" = smoking_status,
"Alcohol Consumption per Week"=alcohol_consumption_per_week, "Physical activity, min/week"=physical_activity_minutes_per_week,
"Diagnosed Diabetes"=diagnosed_diabetes,  "Diabetes Stage"=diabetes_stage) %>%
flextable()
max(typed_data$physical_activity_minutes_per_week)
typed_data[typed_data$physical_activity_minutes_per_week == 751, ] %>%
select("Age" = age, "Gender" = gender, "Smoking" = smoking_status,
"Alcohol Consumption per Week"=alcohol_consumption_per_week, "Physical activity, min/week"=physical_activity_minutes_per_week,
"Diagnosed Diabetes"=diagnosed_diabetes,  "Diabetes Stage"=diabetes_stage) %>%
flextable()%>%
align(align="center")
max(typed_data$physical_activity_minutes_per_week)
typed_data[typed_data$physical_activity_minutes_per_week == 751, ] %>%
select("Age" = age, "Gender" = gender, "Smoking" = smoking_status,
"Alcohol Consumption per Week"=alcohol_consumption_per_week, "Physical activity, min/week"=physical_activity_minutes_per_week,
"Diagnosed Diabetes"=diagnosed_diabetes,  "Diabetes Stage"=diabetes_stage) %>%
flextable() %>%
align(align="center")
typed_data %>%
select(where(is.numeric)) %>%
pivot_longer(cols = everything(), names_to = 'variables', values_to = 'values') %>%
mutate(variables = as.factor(variables)) %>%
group_by(variables) %>%
mutate(scaled_values = scale(values)) %>%
ungroup() %>%
ggplot(aes(x = variables, y = scaled_values, fill = variables)) +
geom_boxplot() +
theme_bw() +
theme(axis.text.x = element_blank(),
legend.text = element_text(size = 10)) +
labs(y = "Z-standartized values", x = "")
typed_data %>%
select(where(is.numeric)) %>%
pivot_longer(cols = everything(), names_to = 'variables', values_to = 'values') %>%
mutate(variables = as.factor(variables)) %>%
group_by(variables) %>%
mutate(scaled_values = scale(values)) %>%
ungroup() %>%
ggplot(aes(x = variables, y = scaled_values, fill = variables)) +
geom_boxplot() +
theme_bw() +
theme(axis.text.x = element_blank(),
legend.text = element_text(size = 8)) +
labs(y = "Z-standartized values", x = "")
typed_data %>%
select(where(is.numeric)) %>%
pivot_longer(cols = everything(), names_to = 'variables', values_to = 'values') %>%
mutate(variables = as.factor(variables)) %>%
group_by(variables) %>%
mutate(scaled_values = scale(values)) %>%
ungroup() %>%
ggplot(aes(x = variables, y = scaled_values, fill = variables)) +
geom_boxplot() +
theme_bw() +
theme(axis.text.x = element_blank(),
legend.text = element_text(size = 8),
legend.title = element_text(size = 9),     # Smaller title
legend.key.size = unit(0.4, "cm")) +
labs(y = "Z-standartized values", x = "")
typed_data %>%
select(where(is.numeric)) %>%
pivot_longer(cols = everything(), names_to = 'variables', values_to = 'values') %>%
mutate(variables = as.factor(variables)) %>%
group_by(variables) %>%
mutate(scaled_values = scale(values)) %>%
ungroup() %>%
ggplot(aes(x = variables, y = scaled_values, fill = variables)) +
geom_boxplot() +
theme_bw() +
theme(axis.text.x = element_blank(),
legend.text = element_text(size = 10),
legend.title = element_text(size = 10),     # Smaller title
legend.key.size = unit(0.4, "cm")) +
labs(y = "Z-standartized values", x = "")
typed_data[typed_data$physical_activity_minutes_per_week == 751, ] %>%
select("Age" = age, "Gender" = gender, "Smoking" = smoking_status,
"Alcohol Consumption per Week"=alcohol_consumption_per_week, "Physical activity, min/week"=physical_activity_minutes_per_week,
"Diagnosed Diabetes"=diagnosed_diabetes,  "Diabetes Stage"=diabetes_stage) %>%
flextable() %>%
align(align="center")
